<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Ravi Bhat&#39;s Projects by raviolibhat</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Ravi Bhat&#39;s Projects</h1>
      <h2 class="project-tagline"></h2>
    </section>

    <section class="main-content">
      <h2>
<a id="who-am-i" class="anchor" href="#who-am-i" aria-hidden="true"><span class="octicon octicon-link"></span></a>Who am I?</h2>

<ul>
<li>Educated in <em>the</em> full-stack: Low-level microchip design, processor architecture, web: back-end, front-end, UI/UX.</li>
<li>Jack-of-all-trades? Not really.</li>
<li>
<strong>Web Architect</strong>. For my career.</li>
<li>Front-end (my preferred zone): Visually appealing, immediate gratification, human interaction.</li>
<li>Back-end (occasional forays): Delayed gratification, can get researchy.</li>
<li>Microchips/Hardware: Heavily delayed gratification, 'nuf said for me.</li>
<li>Technical debt collector.</li>
<li>Wantrapreneur, in a good way :)</li>
</ul>

<hr>

<h1>
<a id="fiddle-fingers" class="anchor" href="#fiddle-fingers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Fiddle Fingers</h1>

<h3>
<a id="history" class="anchor" href="#history" aria-hidden="true"><span class="octicon octicon-link"></span></a>History</h3>

<ul>
<li>Invented in 2002</li>
<li>Result of an internal contest at Xilinx, a semiconductor company</li>
</ul>

<h3>
<a id="inputs" class="anchor" href="#inputs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Inputs</h3>

<ul>
<li>4 finger-buttons</li>
<li>1 reset</li>
<li>1 on-board 555 clock</li>
</ul>

<h3>
<a id="outputs" class="anchor" href="#outputs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Outputs</h3>

<ul>
<li>4 level-LEDs</li>
<li>4 value-LEDs</li>
<li>1 7-segment score display</li>
</ul>

<h3>
<a id="description" class="anchor" href="#description" aria-hidden="true"><span class="octicon octicon-link"></span></a>Description</h3>

<p>Fiddle Fingers is designed to be used in child development centers, handicapped rehabilitation centers or simply as a toy for all ages. It is a game that tests finger-eye reflex coordination. The game consists of four buttons that the player places their four fingers on, which excludes the thumb.  When the game is started, one LED in four, lights up.  The player then depresses
the finger that corresponds to the LED.  Then, the lit LED turns off and another one lights up. The player has to then depress that LED button and no other finger.  This process is repeated and gets faster and faster.</p>

<p>The aim is to be quick at pressing the button corresponding to the LED that is on.  This tests the player's eye-finger reflex speed.  It is a good tool to improve the coordination of misfortunate disabled people who suffer with respect to hand-eye coordination.</p>

<p>A display of four LEDs shows the player what level they have achieved.  There are five LEDs. The game starts with none of the four LEDs lit up, hence level 0.  Then 1 lights up as the speed increases, then another and so on till all four are lit up.  Once this level is completed the game stops. It should be very difficult if not impossible to get to this stage.</p>

<p>Another display which is a 7-segment display shows the player's current score.  This is a count of how many LED presses the player has missed.  When this reaches six the game ends. Hence, the best player has the least score, and the highest level.</p>

<p>Possible future modifications are increasing the score limit, cycling through the levels to attain more levels, changing the initial start speed of the game etc.</p>

<h3>
<a id="patent-pending" class="anchor" href="#patent-pending" aria-hidden="true"><span class="octicon octicon-link"></span></a>Patent Pending</h3>

<p><a href="http://raviolibhat.github.io/patent_figs.pdf">figs</a></p>

<hr>

<h1>
<a id="easy-url-routing-with-angularjs" class="anchor" href="#easy-url-routing-with-angularjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Easy URL Routing with AngularJS</h1>

<h3>
<a id="goals" class="anchor" href="#goals" aria-hidden="true"><span class="octicon octicon-link"></span></a>Goals</h3>

<ul>
<li>URL Routing Service</li>
<li>Drive web application state from the URL</li>
</ul>

<h3>
<a id="why" class="anchor" href="#why" aria-hidden="true"><span class="octicon octicon-link"></span></a>Why?</h3>

<ul>
<li>Browsing within a Single Page Application</li>
<li>Supporting browser back, forward, refresh buttons</li>
<li>Bookmarking and linking from other pages</li>
</ul>

<h3>
<a id="when" class="anchor" href="#when" aria-hidden="true"><span class="octicon octicon-link"></span></a>When?</h3>

<p>2013, supporting older Internet Explorer versions</p>

<h3>
<a id="what" class="anchor" href="#what" aria-hidden="true"><span class="octicon octicon-link"></span></a>What?</h3>

<p>Existing options at the time:</p>

<ul>
<li>ngRoute module</li>
<li>External ui-router package</li>
<li>Leveraging $location (the winner)</li>
<li>Vanilla JavaScript, non-Angular</li>
</ul>

<h3>
<a id="how" class="anchor" href="#how" aria-hidden="true"><span class="octicon octicon-link"></span></a>How?</h3>

<p>Remember: Supporting older browsers means no HTML5 History API</p>

<p>Basic URL format:
<code>http://host/path#?param1=value1&amp;param2=value2&amp;paramN=valueN</code>
Examples:</p>

<ul>
<li><code>?view=productAye</code></li>
<li><code>?view=productAye&amp;subview=report</code></li>
<li><code>?view=productAye&amp;subview=report&amp;sort=date</code></li>
<li><code>?view=productAye&amp;subview=detail</code></li>
<li><code>?view=productBee&amp;subview=detail</code></li>
<li><code>?view=productBee&amp;subview=detail&amp;report=123</code></li>
</ul>

<p>Entities:</p>

<ul>
<li>Location model: contains the name/value pairs</li>
<li>Root scope: contains the Location model</li>
<li>Location service: Built on $location, exposes a register() API</li>
<li>Child scopes</li>
</ul>

<p>Components (directives) that use browser navigation, define URL parameters by using the Location service's register().
All bindings to such parameters by any component are done on the Location model.
Example actions:</p>

<ul>
<li>
<p>Switch views based on URL parameter 'subview': ng-switch on $root.locationModel.subview, target 'report' vs 'detail' etc.</p>

<pre><code>&lt;div ng-switch="$root.locationModel.subview"&gt;
    &lt;overview ng-switch-when="overview"&gt;&lt;/overview&gt;
    &lt;report ng-switch-when="report"&gt;&lt;/report&gt;
    &lt;detail ng-switch-when="detail"&gt;&lt;/detail&gt;
&lt;/div&gt;
</code></pre>
</li>
<li>
<p>Set sort column indication on a detail table: ng-class on $root.locationModel.sort</p>

<pre><code>&lt;div ng-class="{'sorted-col': col==$root.locationModel.sort}"&gt;&lt;/div&gt;
</code></pre>
</li>
<li>
<p>More complex actions: $watch a subset of parameters in $root.locationModel</p>

<pre><code>$scope.$watch(
    function() {
        var locationModel = angular.copy($rootScope.locationModel);
        delete locationModel.report;
        delete locationModel.sort;

        return locationModel;
    },
    function() {
        // do things independent of a report or sorting change
    },
    true
);
</code></pre>
</li>
</ul>

<p>When components are destroyed, any parameters they defined are removed from locationModel automatically.
URL parameters with default values, set with register(), are hidden from the URL.</p>

<p>Code:</p>

<pre><code>// used to provide browser history support: two-way binds the location params with a model
angular.module('my.services', []).factory('myLocation', ['$rootScope', '$location', function($rootScope, $location) {

    var locationModel = {};
    $rootScope.locationModel = locationModel;

    var paramDefaults = {};

    var updateLocationModel = function() {

        var locationParams = $location.search();

        // take location params and update the model, setting defaults as needed
        for (var param in paramDefaults) {

            if (param in locationParams) {
                if (typeof paramDefaults[param] == "number") {
                    locationModel[param] = parseInt(locationParams[param]);
                }
                else {
                    locationModel[param] = locationParams[param];
                }
            }
            else {
                locationModel[param] = paramDefaults[param];
            }
        }

        // copy any remaining non-default location params
        for (var param in locationParams) {

            if (!(param in paramDefaults)) {
                locationModel[param] = locationParams[param];
            }
        }
    };

    var updateLocationSearch = function() {

        var replaceLocation = true;
        var oldLocationParams = $location.search();
        var locationParams = {};

        // only include non-default parameters in location.search
        for (var param in paramDefaults) {

            if (locationModel[param] != paramDefaults[param]) {
                locationParams[param] = locationModel[param];

                if (locationParams[param] != oldLocationParams[param]) {
                    replaceLocation = false;
                }
            }
        }

        // also include any remaining params
        for (var param in locationModel) {

            if (!(param in paramDefaults)) {
                locationParams[param] = locationModel[param];

                if (locationParams[param] != oldLocationParams[param]) {
                    replaceLocation = false;
                }
            }
        }

        if (Object.keys(locationParams).length == 0) {
            // prevent an infinite digest (see Angular issues 9635 and 10228)
            // ...remove after Angular upgrade fixes bug.
            return;
        }

        if (replaceLocation) {
            $location.replace();
        }

        $location.search(locationParams);
    };

    var registrations = 0;
    var deregistrationToFunction = null;
    var deregistrationFroFunction = null;

    return {

        register: function($scope, scopeParamDefaults) {

            angular.extend(paramDefaults, scopeParamDefaults);

            updateLocationModel();

            if (registrations == 0) {
                // bind location.search params to model
                deregistrationToFunction = $rootScope.$on('$locationChangeStart', updateLocationModel);

                // bind model to location.search params
                deregistrationFroFunction = $rootScope.$watchCollection("ns.locationModel", updateLocationSearch);
            }

            registrations++;

            $scope.$on("$destroy", function() {

                for (var param in scopeParamDefaults) {
                    delete locationModel[param];
                    delete paramDefaults[param];
                }

                registrations--;

                if (registrations == 0) {
                    deregistrationToFunction();
                    deregistrationFroFunction();
                }
            });
        }
    };
}])
</code></pre>

<p>Contracts:</p>

<ul>
<li>Child components should not define the same parameter names as a parent. If needed, use namespaces.</li>
<li>Order of parameters is the order of register() invocations, but not guaranteed. This means navigation within an app generally has good order. But if a bookmark link is navigated to, the order of parameters may change upon navigation, though it won't add an extra navigation.</li>
</ul>

<h3>
<a id="derived-goals" class="anchor" href="#derived-goals" aria-hidden="true"><span class="octicon octicon-link"></span></a>Derived Goals</h3>

<ul>
<li>Easy to learn and use, both internally (engineering) and externally (marketing)</li>
</ul>

<h3>
<a id="derived-ungoals" class="anchor" href="#derived-ungoals" aria-hidden="true"><span class="octicon octicon-link"></span></a>Derived Ungoals</h3>

<ul>
<li>Internal application (non-URL) routing</li>
<li>Object-oriented URL routing</li>
<li>Complexity</li>
</ul>

<hr>

<h1>
<a id="inheritance-patterns-in-javascript-and-angularjs-and-some-python" class="anchor" href="#inheritance-patterns-in-javascript-and-angularjs-and-some-python" aria-hidden="true"><span class="octicon octicon-link"></span></a>Inheritance patterns in JavaScript and AngularJS (and some Python)</h1>

<h3>
<a id="controllers" class="anchor" href="#controllers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Controllers</h3>

<ul>
<li>
<p>Using inheritance and/or mixins:</p>

<p>angular.module('my.services', []).factory('myClass', function() {</p>

<pre><code>var BaseController = function() {

    this.modelDef = null;
};
BaseController.prototype.setupModel = function() {

    var process = function(modelDef) {
        // process modelDef into model
    };
    this.model = process(this.modelDef);
};

return {
    BaseController: BaseController
};
</code></pre>

<p>});</p>

<p>angular.module('my.services', []).factory('myMixin', ['restData', function(restData) {</p>

<pre><code>var tabulate = function() {
    // tabulate the list-type models from this.modelDefs
};

var restify = function() {
    // call back-end services via restData service
};

// no prototype functions
return {
    tabulate: tabulate,
    restify: restify
};
</code></pre>

<p>}]);</p>

<p>angular.module('my.directives', ['my.services'])
    .directive('myReport', ['myClass', function(myClass) {</p>

<pre><code>    var SubController = function($filter, myMixin) {

        myClass.BaseController.apply(this);

        angular.extend(this, myMixin); // mix in to controller-bound scope

        this.modelDef = {
            // set of model definitions
        };
        this.setupModel();
    };
    SubController.prototype = Object.create(myClass.BaseController.prototype);
    SubController.$inject = ['$filter', 'myMixin'];

    return {
        scope: {
            // scope props
        },
        templateUrl: '/path/file.html',

        controller: SubController,
        controllerAs: 'ctrl',
        bindToController: true,

        link: function ($scope, $element, $attrs) {
            // do things
        }
    };
}]);
</code></pre>
</li>
<li>
<p>Decorator pattern:</p>

<p>angular.module('my', ['my.services'])
    .decorator('$controller', ['myMixin', '$delegate', function (myMixin, $delegate) {</p>

<pre><code>    return function (constructor, locals) {

        var controller = $delegate.apply(null, arguments);

        return angular.extend(function () {

            return angular.extend(controller(), myMixin); // mix in to controller-bound scopes

            // one can also do things to the instance of controller() based on the type of 'constructor'

        }, controller);
    };
}]);
</code></pre>
</li>
</ul>

<h3>
<a id="services" class="anchor" href="#services" aria-hidden="true"><span class="octicon octicon-link"></span></a>Services</h3>

<ul>
<li>
<p>Using inheritance and/or mixins:</p>

<p>angular.module('my.services', []).factory('mySubClass', ['myClass', function() {</p>

<pre><code>var SubController = function($filter) {

    myClass.BaseController.apply(this);

    this.modelDef = {
        // set of model definitions
    };
    this.setupModel();
};
SubController.prototype = Object.create(myClass.BaseController.prototype);

return {
    SubController: SubController
};
</code></pre>

<p>}]);</p>
</li>
<li>
<p>Decorator pattern:</p>

<p>angular.module('my', [])
    .decorator('myService', function ($delegate) {</p>

<pre><code>    return function() {
        // do things
        return $delegate();
    }
});
</code></pre>
</li>
</ul>

<h3>
<a id="directives" class="anchor" href="#directives" aria-hidden="true"><span class="octicon octicon-link"></span></a>Directives</h3>

<ul>
<li>Using inheritance and/or mixins: By inheriting directive controllers as opposed to directives: see myReport directive above.</li>
<li>Using the 'require' parameter in the directive definition, for directive controller dependencies.</li>
<li>Directive wrapping: <a href="http://thaiat.github.io/blog/2014/03/10/extending-an-existing-directive-in-angularjs/">http://thaiat.github.io/blog/2014/03/10/extending-an-existing-directive-in-angularjs/</a>
</li>
<li>
<p>Decorator pattern:</p>

<p>angular.module('my', [])
    .decorator('myReportDirective', function ($delegate) {
        // do things
        return $delegate;
    });</p>
</li>
</ul>

<p>Note: There is no $directive service like there is $controller (above), so you can't blanket all directives this way.</p>

<h3>
<a id="javascript-oo" class="anchor" href="#javascript-oo" aria-hidden="true"><span class="octicon octicon-link"></span></a>JavaScript OO</h3>

<ul>
<li>Everything's derived from Object, including Class and Instance</li>
<li>Allows for SubInstances in addition to SubClasses</li>
<li>Multiple inheritance by mixins, i.e. copy stuff over: works due to the two points above</li>
<li>Flexible</li>
</ul>

<h3>
<a id="python-oo-im-not-an-expert" class="anchor" href="#python-oo-im-not-an-expert" aria-hidden="true"><span class="octicon octicon-link"></span></a>Python OO (I'm not an expert)</h3>

<ul>
<li>Class is separate from Instance</li>
<li>Does not allow for SubInstances</li>
<li>Multiple inheritance (for Class) is built into syntax</li>
</ul>

<h3>
<a id="when-oo-breaks-down" class="anchor" href="#when-oo-breaks-down" aria-hidden="true"><span class="octicon octicon-link"></span></a>When OO breaks down</h3>

<ul>
<li>Deep inheritance hierarchies that create rigid dependencies that are very difficult to break when requirements change</li>
<li>JavaScript's flexibility may alleviate rigidity by providing crutches while the hierarchies are reworked, but this needs to be short-term only</li>
<li>In Python, maybe preplan for retiring old things and starting anew</li>
<li>In the end for both: Build shallow.</li>
</ul>

      <footer class="site-footer">

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
